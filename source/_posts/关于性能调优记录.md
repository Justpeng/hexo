---
title: Web部署应用性能调优问题
date: 2016-09-02 17:58:27
description: "本文用于记录在维护web应用过程中遇到的问题，以及可能的解决方法！"
categories: [性能调优,Java Web,Oracle]
tags: [oracle,java Web]

---

## 本文目的

>记录在维护JavaWeb服务的性能问题时，一些可能的解决方法，涉及方面有局面性。（持续更新）

## 已遇到的问题

-系统卡住不动，一些操作无法进行
> 原因：删除数据，涉及其他数据表，该表的主键没有索引，导致锁表情况发生。
``` bash
1 是否死锁查询：
select username,lockwait,status,machine,program from v$session where sid in (select session_id from    v$locked_object) 
2 锁表语句查询：
select sql_text from v$sql where hash_value in ( select sql_hash_value from v$session where sid in (select   session_id from v$locked_object) )

```
-系统使用一段时间后，速度变慢
>这个最后解决的方式比较特殊，更换tomcat。现象是：可以明显看到 tomcat console后台打印速度变慢，觉得出现这种现场的原因是一些不可控的因素导致tomcat某些文件丢失。

## 在解决问题时，需要验证的一些点

### 最直接，查看日志

>从日志中获取有效信息，如是有报错信息

### oracle 连接池配置

- prototypeCount  连接池中可用的连接数量.如果当前的连接池中的连接少于这个数值.新的连接将被建立
- maximumConnectionCount  最大的数据库连接数
- minimumConnectionCount  最小的数据库连接数
- maximumConnectionLifetime  一个线程的最大寿命
- maximumActiveTime 如果housekeeper检测到某个线程的活动时间大于这个数值.它将会杀掉这个线程. 而且与 housekeeper检测的时间间隔有关

> 每个属性值的设置，需要与服务器的性能进行选择，如，一般maximumConnectionCount比minimumConnectionCount 多十几个数值。

### oracle 进程和会话值

-查询
``` bash
select count(*) from v$process; 
select count(*) from v$session; 
show parameter processes; 
```
-修改，如根据应用服务器性能设置，sessions值为 1.1*processes+5，然后需要重启服务
``` bash
alter system set processes = 500 scope = spfile;
alter system set sessions = 885 scope = spfile;
```
### 用户实例权限，至少需要三种

> connect 、resource 和 recovery_catalog_ower

### 其他特殊情况
> 如jdk、tomcat丢失文件，更换即可